XQUERY import module namespace catull = "http://www.ffzg.unizg.hr/klafil/catull" at "../scripts/repo/catull.xqm";declare function local:indexurns() { (: list all URNs :) for $t in collection("catullus-cts")//*:text/*:body/*:div let $texturns := for $id in $t//*[@n] let $urnsubstring := string-join($id/ancestor-or-self::*[@n and not(@type=("edition", "translation") or name()="body")]/@n, ".") let $baseurn2 := $id/ancestor::*:div[@type=("edition","translation")]/@n return element cts {  element urn { $urnsubstring }, element dbid {  db:node-id($id) } } let $baseurn3 := $t/@n return element doc {  $baseurn3 , element textgroup { catull:textgroup-from-urn(data($baseurn3)) },  element work { catull:work-from-urn2($baseurn3) },  $texturns } }; let $list := element idx { local:indexurns() } let $address := replace(file:parent(static-base-uri()), "bxs/", "indices/catullus-cts-idx2.xml") return file:write($address , $list)